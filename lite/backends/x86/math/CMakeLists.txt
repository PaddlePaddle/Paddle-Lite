FILE(GLOB x86_math_src ${CMAKE_CURRENT_SOURCE_DIR}/*.cc)
FILE(GLOB x86_avx_math_src ${CMAKE_CURRENT_SOURCE_DIR}/avx/*.cc)

if (WITH_AVX AND AVX_FOUND)
  set(x86_math_src ${x86_math_src} ${x86_avx_math_src})
endif()
set(x86_math_deps ${math_library_DEPS} ${math_common_deps})
if(WITH_MKL)
  if(WITH_STATIC_MKL)
    set(x86_math_deps ${x86_math_deps} ${MKLML_LIBRARIES})
  else()
    set(x86_math_deps ${x86_math_deps} dynload_mklml)
  endif()
endif()

lite_cc_library(x86_math SRC ${x86_math_src} DEPS ${x86_math_deps})
add_dependencies(x86_math eigen3)
