if (NOT LITE_WITH_MMA)
    return()
endif()

set(LITE_MMA_PATH "${PADDLE_SOURCE_DIR}/lite/backends/mma")
set(LITE_MMA_LLDRV_PATH "${PADDLE_SOURCE_DIR}/lite/backends/mma/lldrv")

message("mma_path ${LITE_MMA_PATH}")
file(GLOB MMA_CPP "${LITE_MMA_PATH}/*.cpp")
file(GLOB LLDRV_CPP "${LITE_MMA_LLDRV_PATH}/*.cpp")
message("mma cpp: ${MMA_CPP}")
set(MMA_ALL_CPP "")
FOREACH(FILE_PATH ${LLDRV_CPP})
    STRING(REGEX REPLACE ".+/(.+\\..*)" "\\1" FILE_NAME ${FILE_PATH})
    list(APPEND MMA_ALL_CPP lldrv/${FILE_NAME})
ENDFOREACH(FILE_PATH)
FOREACH(FILE_PATH ${MMA_CPP})
    STRING(REGEX REPLACE ".+/(.+\\..*)" "\\1" FILE_NAME ${FILE_PATH})
    list(APPEND MMA_ALL_CPP ${FILE_NAME})
ENDFOREACH(FILE_PATH)
message("mma src: ${MMA_ALL_CPP}")
cc_library(kernel_mma SRCS ${MMA_ALL_CPP})
cc_library(mma_target_wrapper SRCS target_wrapper.cpp DEPS kernel_mma)
