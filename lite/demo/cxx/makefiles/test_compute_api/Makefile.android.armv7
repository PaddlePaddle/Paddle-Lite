ARM_ABI = arm7
export ARM_ABI

include ../Makefile.def

LITE_ROOT=../../../

CXX_INCLUDES = $(INCLUDES) -I$(LITE_ROOT)/cxx/include

CXX_LIBS = -L$(LITE_ROOT)/cxx/lib/ -lpaddle_light_api_shared $(SYSTEM_LIBS)

CXX_DEFINES += -DLITE_WITH_COMPUTE_API

###############################################################
# How to use one of static libaray:                           #
#  `libpaddle_api_full_bundled.a`                             #
#  `libpaddle_api_light_bundled.a`                            #
###############################################################
# Note: default use lite's shared library.                    #
###############################################################
# 1. Comment above line using `libpaddle_light_api_shared.so`
# 2. Undo comment below line using `libpaddle_api_light_bundled.a`

#CXX_LIBS = $(LITE_ROOT)/cxx/lib/libpaddle_api_light_bundled.a $(SYSTEM_LIBS)

#activation
test_activation: test_activation.o
	$(CC) $(SYSROOT_LINK) $(CXXFLAGS_LINK) test_activation.o -o test_activation  $(CXX_LIBS) $(LDFLAGS)

test_activation.o: activation_test.cc
	$(CC) $(SYSROOT_COMPLILE) $(CXX_DEFINES) $(CXX_INCLUDES) $(CXX_FLAGS) -o test_activation.o -c activation_test.cc

# conv
test_conv: test_conv.o
	$(CC) $(SYSROOT_LINK) $(CXXFLAGS_LINK) test_conv.o -o test_conv  $(CXX_LIBS) $(LDFLAGS)

test_conv.o: conv_test.cc
	$(CC) $(SYSROOT_COMPLILE) $(CXX_DEFINES) $(CXX_INCLUDES) $(CXX_FLAGS) -o test_conv.o -c conv_test.cc

# int8 conv	
test_conv_int8: test_conv_int8.o
	$(CC) $(SYSROOT_LINK) $(CXXFLAGS_LINK) test_conv_int8.o -o test_conv_int8  $(CXX_LIBS) $(LDFLAGS)

test_conv_int8.o: conv_int8_test.cc
	$(CC) $(SYSROOT_COMPLILE) $(CXX_DEFINES) $(CXX_INCLUDES) $(CXX_FLAGS) -o test_conv_int8.o -c conv_int8_test.cc

.PHONY: clean
clean:
	rm -f test_activation.o
	rm -f test_activation
	rm -f test_conv.o
	rm -f test_conv
	rm -f test_conv_int8.o
	rm -f test_conv_int8
